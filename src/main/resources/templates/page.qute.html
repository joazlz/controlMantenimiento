<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>Hibernate Search + Elasticsearch quickstart - Quarkus</title>
    <!-- Semantic UI -->
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/semantic.min.css" />
    <script src="//code.jquery.com/jquery-3.1.1.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/semantic.min.js"></script>
    <style type="text/css">
        .ui.menu .item {
            font-size: 20px;
        }

        .contenido {
            margin-top: 5em;
            border-bottom: 1px solid #CCC;
            border-top: 1px solid #CCC;
            padding-top: 1em;
            padding-bottom: 1em;
        }

        .buscar {
            margin-top: 2em;
        }

        .contenido .meta {
            margin-top: 5px;
            margin-bottom: 15px;
        }
    </style>
    <!-- Load AngularJS -->
    <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.4.8/angular.min.js"></script>
    <script type="text/javascript">
        var app = angular.module("InventarioManagement", []);

        //Controller Part
        app.controller("InventarioManagementController", ['$scope', '$http', '$httpParamSerializerJQLike', function ($scope, $http, $httpParamSerializerJQLike) {

            // initialize page with default data which is blank in this example
            $scope.lista = [{ "nombre": "areas", "cantidad": 0 }, { "nombre": "equipos", "cantidad": 0 }, { "nombre": "actividades", "cantidad": 0 }];
            $scope.areas = [];
            $scope.equipos = [];
            $scope.actividades = [];
            $scope.pattern = '';
            $scope.formulario = {};

            // initializes the data from the REST endpoint
            iniciar()

            function getAreas() {
                $http({
                    method: 'GET',
                    url: '/equipo/area/buscar?pattern=' + $scope.pattern
                }).then(function successCallback(response) {
                    $scope.areas = response.data;
                    $scope.lista[0].cantidad = $scope.areas.length
                }, function errorCallback(response) {
                    console.log(response.statusText);
                });
            }
            function getEquipos() {
                $http({
                    method: 'GET',
                    url: '/equipo/buscar?pattern=' + $scope.pattern
                }).then(function successCallback(response) {
                    $scope.equipos = response.data;
                    $scope.lista[1].cantidad = $scope.equipos.length
                }, function errorCallback(response) {
                    console.log(response.statusText);
                });
            }
            function getActividades() {
                $http({
                    method: 'GET',
                    url: '/actividad/buscar?pattern=' + $scope.pattern
                }).then(function successCallback(response) {
                    $scope.actividades = response.data;
                    $scope.lista[2].cantidad = $scope.actividades.length
                }, function errorCallback(response) {
                    console.log(response.statusText);
                });
            }


            function iniciar() {
                $('#contenidoInicio').show();
                $('#contenidoAreas').hide();
                $('#contenidoEquipos').hide();
                $('#contenidoActividades').hide();
                getAreas()
                getEquipos()
                getActividades()
            }

            $scope.ver = function (item) {
                switch (item.nombre) {
                    case "areas":
                        $('#contenidoAreas').show();
                        $('#contenidoInicio').hide();
                        $('#contenidoEquipos').hide();
                        $('#contenidoActividades').hide();
                        break;
                    case "equipos":
                        $('#contenidoEquipos').show();
                        $('#contenidoAreas').hide();
                        $('#contenidoInicio').hide();
                        $('#contenidoActividades').hide();
                        break;
                    case "actividades":
                        $('#contenidoEquipos').hide();
                        $('#contenidoAreas').hide();
                        $('#contenidoInicio').hide();
                        $('#contenidoActividades').show();
                        break;
                    default:
                        break;
                }
            }
            $scope.verInicio = function () {
                $('#contenidoAreas').hide();
                $('#contenidoEquipos').hide();
                $('#contenidoActividades').hide();
                $('#contenidoInicio').show();
            }

            $scope.AreaModal = function (accion, area) {
                switch (accion) {
                    case "agregar":
                        $scope.areaModalTitle = "Agregar area";
                        break;

                    case "editar":
                        $scope.areaModalTitle = "Editar area "
                        $scope.formulario.area = area;
                        break;

                    default:
                        break;
                }
                $('#modal-area').modal('show');
            }

            //Guardar Editar
            $scope.agregarEditarArea = function () {
                data = {};
                if ($scope.formulario.area.id == -1 || $scope.formulario.area.id === undefined) {
                    method = 'PUT';
                    url = '/equipo/area';
                    data.nombre = $scope.formulario.area.nombre;
                } else {
                    method = 'POST';
                    url = '/equipo/area/' + $scope.formulario.area.id;
                    data.nombre = $scope.formulario.area.nombre;
                }
                $http({
                    method: method,
                    url: url,
                    data: $httpParamSerializerJQLike(data),
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded'
                    }
                }).then($scope._correcto, $scope._error);
            }

            //Eliminar
            $scope.eliminar = function (type, element) {
                $http({
                    method: 'DELETE',
                    url: '/equipo/' + type + '/' + element.id
                }).then($scope._correcto, $scope._error);
            };

            //Busqueda
            function _actualizarDatos() {
                getAreas()
                getEquipos()
                getActividades()
            }

            $scope.actualizar = function () {
                _actualizarDatos();
            }

            function _limpiarFormulario() {
                $scope.formulario.area = {
                    id: -1,
                    nombre: '',
                };
            }

            $scope._error = function (response) {
                alert(response.data.message || response.statusText);
                $scope.limpiarFormulario();
            }

            $scope._correcto = function (response) {
                $scope.pattern = '';
                _actualizarDatos();
                _limpiarFormulario();
            }


        }]);
    </script>
</head>

<body ng-app="InventarioManagement" ng-controller="InventarioManagementController">

    {! MENU !}
    <div class="ui large top fixed hidden menu">
        <div class="ui container">
            <a class="header item" ng-click="verInicio()">
                <img class="logo" src="img/logo.png" alt="Quarkus logo" style="width:80px;">
                Control de Equipos
            </a>
            <div class="right menu">
                <div class="item">
                    <i class="user circle icon"></i>
                </div>
                <div class="item">
                    <i class="bell icon"></i>
                </div>
            </div>
        </div>
    </div>

    <!--AREAS -->
    <div id="contenidoAreas" class="ui container contenido">
        <div class="content">
            <button class="ui blue labeled icon button" ng-click="AreaModal('agregar')"><i class="plus circle icon"></i>
                Agregar area</button>
            <button class="ui grey labeled icon button" ng-click="verInicio()"><i class="redo icon"></i>
                Resumenes</button>
        </div>
        <h2 class="ui right floated header">Areas</h2>
        <div class="ui clearing divider">
            <table class="ui celled table">
                <thead>
                    <tr>
                        <th>Nombre</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    <tr ng-repeat="area in areas">
                        <td>{{area.nombre}}</td>
                        <td>
                            <button class="ui basic green button" ng-click="AreaModal('editar',area)"><i
                                    class="pencil alternate icon"></i>
                                Editar</button>
                            <button ng-if="{identity.roles.contains(" admin")}" class="ui basic red button"
                                ng-click="eliminar('area', area)"><i class="trash alternate outline icon"></i>
                                Eliminar</button>
                        </td>
                    </tr>
                    {! <tr class="error">
                        <td>Jimmy</td>
                        <td>Cannot pull data</td>
                        <td>None</td>
                        <td>
                            <button class="ui basic green button" ng-click="AreaModal('editar',area)"><i
                                    class="pencil alternate icon"></i>
                                Editar</button>
                            <button ng-if="{identity.roles.contains(" admin")}" class="ui basic red button"
                                ng-click="eliminar('area', area)"><i class="trash alternate outline icon"></i>
                                Eliminar</button>
                        </td>
                    </tr>
                    <tr>
                        <td>Jaime</td>
                        <td>Aprobado</td>
                        <td class="error"><i class="attention icon"></i> Clasificado</td>
                        <td>
                            <button class="ui basic green button" ng-click="AreaModal('editar',area)"><i
                                    class="pencil alternate icon"></i>
                                Editar</button>
                            <button ng-if="{identity.roles.contains(" admin")}" class="ui basic red button"
                                ng-click="eliminar('area', area)"><i class="trash alternate outline icon"></i>
                                Eliminar</button>
                        </td>
                    </tr>
                    <tr>
                        <td>Juana</td>
                        <td>Aprobado</td>
                        <td>None</td>
                        <td>
                            <button class="ui basic green button" ng-click="AreaModal('editar',area)"><i
                                    class="pencil alternate icon"></i>
                                Editar</button>
                            <button ng-if="{identity.roles.contains(" admin")}" class="ui basic red button"
                                ng-click="eliminar('area', area)"><i class="trash alternate outline icon"></i>
                                Eliminar</button>
                        </td>
                    </tr> !}
                </tbody>
            </table>

        </div>
    </div>

    <!--EQUIPOS -->
    <div id="contenidoEquipos" class="ui container contenido">
        <div class="content">
            <button class="ui blue labeled icon button" ng-click="EquipoModal('agregar')"><i
                    class="plus circle icon"></i>
                Agregar equipo</button>
            <button class="ui grey labeled icon button" ng-click="verInicio()"><i class="redo icon"></i>
                Resumenes</button>
        </div>
        <h2 class="ui right floated header">Equipos</h2>
        <div class="ui clearing divider">
            <table class="ui celled table">
                <thead>
                    <tr>
                        <th>Modelo</th>
                        <th>Voltaje</th>
                        <th>Amperaje</th>
                        <th>Flipon</th>
                        <th>Cable Alimentacion</th>
                        <th>Tranformador</th>
                        <th>Contactor</th>
                        <th>Termostato</th>
                        <th>Tarjeta Electronica</th>
                        <th>Selector</th>
                        <th>Retardor</th>
                        <th>Area</th>
                        <th>Estado</th>
                        <th>Tipo Gas</th>
                        <th>Capacidad BTU</th>
                        <th>Tipo Filtro Deshidratador</th>
                        <th>Rango Presion Alta</th>
                        <th>Rango Presion Baja</th>
                        <th>marca</th>
                        <th>pH</th>
                        <th>Tipo Equipo</th>
                        <th>Presostato Alta</th>
                        <th>Presostato Baja</th>
                        <th>Tipos Motor</th>
                        <th>Tipos Compresor</th>
                        <th>Baterias</th>
                        <th>Tags</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    <tr ng-repeat="equipo in equipos">
                        <td>{{equipo.modelo}}</td>
                        <td>{{equipo.voltaje}}</td>
                        <td>{{equipo.amperaje}}</td>
                        <td>{{equipo.flipon}}</td>
                        <td>{{equipo.cableAlimentacion}}</td>
                        <td>{{equipo.tranformador}}</td>
                        <td>{{equipo.contactor}}</td>
                        <td>{{equipo.termostato}}</td>
                        <td>{{equipo.tarjetaElectronica}}</td>
                        <td>{{equipo.selector}}</td>
                        <td>{{equipo.retardor}}</td>
                        <td>{{equipo.area.nombre}}</td>
                        <td>{{equipo.estado.nombre}}</td>
                        <td>{{equipo.tipoGas.nombre}}</td>
                        <td>{{equipo.capacidadBTU.nombre}}</td>
                        <td>{{equipo.tipoFiltroDeshidratador.nombre}}</td>
                        <td>
                            minimo: {{equipo.rangoPresionAlta.minimo}}
                            <br>
                            maximo: {{equipo.rangoPresionAlta.maximo}}
                        </td>
                        <td>
                            minimo: {{equipo.rangoPresionBaja.minimo}}
                            <br>
                            maximo: {{equipo.rangoPresionBaja.maximo}}
                        </td>
                        <td>{{equipo.marca.nombre}}</td>
                        <td>{{equipo.pH.nombre}}</td>
                        <td>{{equipo.tipoEquipo.nombre}}</td>
                        <td>{{equipo.presostatoAlta.nombre}}</td>
                        <td>{{equipo.presostatoBaja.nombre}}</td>
                        <td>{{equipo.tiposMotor.length}}</td>
                        <td>{{equipo.tiposCompresor.length}}</td>
                        <td>{{equipo.baterias.length}}</td>
                        <td>{{equipo.tags.length}}</td>
                        <td>
                            <button class="ui basic green button" ng-click="equipoModal('editar',equipo)"><i
                                    class="pencil alternate icon"></i>
                                Editar</button>
                            <button ng-if="{identity.roles.contains(" admin")}" class="ui basic red button"
                                ng-click="eliminar('equipo', equipo)"><i class="trash alternate outline icon"></i>
                                Eliminar</button>
                        </td>
                    </tr>
                    {! <tr class="error">
                        <td>Jimmy</td>
                        <td>Cannot pull data</td>
                        <td>None</td>
                        <td>
                            <button class="ui basic green button" ng-click="AreaModal('editar',area)"><i
                                    class="pencil alternate icon"></i>
                                Editar</button>
                            <button ng-if="{identity.roles.contains(" admin")}" class="ui basic red button"
                                ng-click="eliminar('area', area)"><i class="trash alternate outline icon"></i>
                                Eliminar</button>
                        </td>
                    </tr>
                    <tr>
                        <td>Jaime</td>
                        <td>Aprobado</td>
                        <td class="error"><i class="attention icon"></i> Clasificado</td>
                        <td>
                            <button class="ui basic green button" ng-click="AreaModal('editar',area)"><i
                                    class="pencil alternate icon"></i>
                                Editar</button>
                            <button ng-if="{identity.roles.contains(" admin")}" class="ui basic red button"
                                ng-click="eliminar('area', area)"><i class="trash alternate outline icon"></i>
                                Eliminar</button>
                        </td>
                    </tr>
                    <tr>
                        <td>Juana</td>
                        <td>Aprobado</td>
                        <td>None</td>
                        <td>
                            <button class="ui basic green button" ng-click="AreaModal('editar',area)"><i
                                    class="pencil alternate icon"></i>
                                Editar</button>
                            <button ng-if="{identity.roles.contains(" admin")}" class="ui basic red button"
                                ng-click="eliminar('area', area)"><i class="trash alternate outline icon"></i>
                                Eliminar</button>
                        </td>
                    </tr> !}
                </tbody>
            </table>
        </div>
    </div>














    {! INICIO !}
    <div id="contenidoInicio" class="ui container contenido">
        <h2 class="ui right floated header">Resumenes</h2>
        <div class="ui clearing divider">
            <div class="ui cards">
                <div class="card" ng-repeat="item in lista">
                    <div class="content">
                        <div class="header">{{ item.nombre }}</div>
                        <div class="meta">
                            {{item.cantidad}}
                        </div>
                        <div class="extra content">
                            <div class="ui two buttons">
                                <button class="ui basic blue button" ng-click="ver(item)">
                                    <i class="eye icon"></i> Ver</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <!-- ACTIVIDADES -->
    <div id="contenidoActividades" class="ui container contenido">
        <div class="content">
            <button class="ui blue labeled icon button" ng-click="AreaModal('agregar')"><i class="plus circle icon"></i>
                Agregar Actividad</button>
            <button class="ui grey labeled icon button" ng-click="verInicio()"><i class="redo icon"></i>
                Resumenes</button>
        </div>
        <h2 class="ui right floated header">Actividades</h2>
        <div class="ui clearing divider">
            <table class="ui celled table">
                <thead>
                    <tr>
                        <th>Descripcion</th>
                        <th>Orden Trabajo</th>
                        <th>Reserva</th>
                        <th>Fecha Inicio Programado</th>
                        <th>Fecha Fin Programado</th>
                        <th>Fecha Inicio Actividad</th>
                        <th>Fecha Fin Actividad</th>
                    </tr>
                </thead>
                <tbody>
                    <tr ng-repeat="actividad in actividades">
                        <td>{{actividad.descripcion}}</td>
                        <td>{{actividad.ordenTrabajo}}</td>
                        <td>{{actividad.reserva}}</td>
                        <td>{{actividad.fechaInicioProgramado}}</td>
                        <td>{{actividad.fechaFinProgramado}}</td>
                        <td>{{actividad.fechaInicioActividad}}</td>
                        <td>{{actividad.fechaFinActividad}}</td>
                        <td>
                            <button class="ui basic green button" ng-click="actividadModal('editar',actividad)"><i
                                    class="pencil alternate icon"></i>
                                Editar</button>
                            <button ng-if="{identity.roles.contains(" admin")}" class="ui basic red button"
                                ng-click="eliminar('actividad', actividad)"><i class="trash alternate outline icon"></i>
                                Eliminar</button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- MODALES -->
    <div class="ui modal" id="modal-area">
        <i class="close icon"></i>
        <div class="header">
            {{ areaModalTitle }}
        </div>
        <div class="content">
            <div class="description">
                <form class="ui form" id="area-formulario">
                    <input type="hidden" name="areaId" ng-model="formulario.area.id" />
                    <div class="required field">
                        <label>Nombre</label>
                        <input type="text" name="nombre" placeholder="nombre" ng-model="formulario.area.nombre"
                            required>
                    </div>
                </form>
            </div>
        </div>
        <div class="actions">
            <button type="submit" class="ui positive right labeled icon button" form="area-formulario"
                ng-click="agregarEditarArea()">
                <i class="checkmark icon"></i>
                Guardar
            </button>
        </div>
    </div>

</body>

</html>